### 1.1 초난감 DAO
먼저 간단하게 JDBC를 이용한 User CURD를 간단하게 다룰것이다. 그래서 먼저 CRUD를 만들기위해 UserDAO ,User 객체생성할것이다. 예제에서는 롬복을 사용하여 객체를 다룰것이다. 그리고 데이터베이스는 Inmemory DB인 H2를 사용할것이다. H2사용법은 [이글](http://dololak.tistory.com/285)에서 확인하자.

먼저 아래와같이 간단하게 유저 객체를 생성해보자.
```java
@Getter
@Setter
@NoArgsConstructor
public class User {
    private String id;
    private String name;
    private String password;


    @Builder
    public User(String id, String name, String password) {
        this.id = id;
        this.name = name;
        this.password = password;
    }


}

```

유저의 정보에 접근할 수 있는 DAO를 아래와같이 만들자.
```java
public class UserDao {
    public void add(User user) throws ClassNotFoundException, SQLException {
        Class.forName("org.h2.Driver");
        Connection c = DriverManager.getConnection("jdbc:h2:tcp://localhost:9092/mem:testdb;MVCC=TRUE", "sa", "");

        PreparedStatement ps = c.prepareStatement("insert into users(id, name, password) values (?, ?, ?)");
        ps.setString(1, user.getId());
        ps.setString(2, user.getName());
        ps.setString(3, user.getPassword());

        ps.executeUpdate();

        ps.close();
        c.close();
    }

    public User get(String id) throws ClassNotFoundException, SQLException {
        Class.forName("org.h2.Driver");
        Connection c = DriverManager.getConnection("jdbc:h2:tcp://localhost:9092/mem:testdb;MVCC=TRUE", "sa", "");

        PreparedStatement ps = c.prepareStatement("select * from users where id = ?");
        ps.setString(1, id);

        ResultSet rs = ps.executeQuery();
        rs.next();

        User user = new User();
        user.setId(rs.getString("id"));
        user.setName(rs.getString("name"));
        user.setPassword(rs.getString("password"));

        rs.close();
        ps.close();
        c.close();

        return user;
    }
}

```
그다음은 실제 User 정보가 담길 디비를 아래와같이 만들어보자.
```sql
CREATE TABLE users (
  id          varchar(10) primary key,
  name varchar(20) not null,
  password varchar(10) not null
);
```

이제 만들어진 코드를 바탕으로 테스트 코드를 아래와같이 작성해보자.

```java
public static void main(String[] args) throws ClassNotFoundException, SQLException {
    UserDao dao = new UserDao();

    User user = new User();
    user.setId("whiteship");
    user.setName("백기선");
    user.setPassword("married");

    dao.add(user);

    System.out.println(user.getId() + " 등록 성공");

    User user2 = dao.get(user.getId());
    System.out.println(user2.getName());
    System.out.println(user2.getPassword());
    System.out.println(user2.getId() + " 조회 성공");
}

```

위와같이 이제 테스트코드를 돌리게되면 데이터베이스를 통해 유저를 등록하고 조회를 할 수 있게 된다. 사실 위코드에서 소스가 작동하는데는 큰문제가 없다. 하지만 잠재적으로 엄청난 버그를 가지고있는 소스임은 분명하다. 그래서 위의 소스를 좀더 안전하고, 유지보수하기 좋은 소스를 만들기위해서 스프링과 결합하여 좀 더 효과적으로, 객체지향적으로 만들어나가는 방법에 대해 알아볼것이다.

* 예제를 실행시키기 위해서는 먼저 메인함수를 실행시켜 서버를 실행시키고 테스트 코드를 실행시키셔야합니다. Main함수가 실행되어야 인메모리 H2디비가 실행되기 떄문입니다.
