# 3.3 변화되는 부분을 추상화하기

추상화를 잘하기위해서는 유연한코드의 설계경험이 많아야한다. 하지만 모든 개발자가 다양한 환경에서 경험이 많은것은 아니기 때문에 변화될 부분을 미리 예측해서 추상화하는것은 쉽지 않다.

경험하지 않은 분야라 하더라도 추상화할 수 있는 방법이 하나 있는데, 그것은 바로 변화되는 부분을 추상화 하는것이다. 요구사항이 바뀔 때 변화되는 부분은 이후에도 변경될 소지가 많다. 그렇기 때문에 변경되는 부분을 추상화하는것이 좋다.


앞서 FlowController예에서 요구사항에 변경에 따라 변화되는부분은 FileDataReader reader = new FileDataReader()였다.

```java
public class FlowController{
    public void process(){
        FileDataReader reader = new FileDataReader();
        byte[] data = reader.read();
        
        Encrpytor encryptor = new Encryptor();
        byte[] encryptedData = encryptor.encrypt(data);

        FileDataWriter writer = new FileDataWriter();
        writer.write(encryptedData);
    }
}
```

추상화가 되어 있지 않은 코드는 주로 동일 구조를 갖는 if-else 블록으로 드러난다. 앞서 FlowController도 추상화되기 전에 다음과 같이 if-else블록을 갖고 있었고, 각 블록의 코드가 거의 동일한 형태를 취했다. 그래서 그 if-else문을 없애고 그 대상을 추상화했다.
```java
public void process(){
    byte[] data = null;
    if(useFile){
        FileDataReader fileReader = new FileDataReader();
        data = fileReader.read();
    }else{
        SocketDataReader socketReader = new SocketDataReader();
        data = socketReader.read();
    }
}
```
위에서 변화되는 부분은 데이터를 읽는 reader가 추가되어진다면 else문이 더늘것이다. 이부분을 하나 추상화해서 팩토리를 만들었다. 


![ByteSource추상화](/assets/ByteSource추상화.jpg)

