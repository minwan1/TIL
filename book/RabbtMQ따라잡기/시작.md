## 활용 용도
각 사용자, 애플리케이션, 장치 , 장소를 연결하는 방법은 여러 확장 가능한 애플리케이션을 개발해야하는 필요성을 대두 시켰다. 새로운 애플리케이션은 기존의 API나 기존 애플리케이션 언어에 상관없이 연결 되어져야한다. 이런 종류의 환경에서 확장성을 제공하는 유일한 방법은 메시징을 사용하는것이고, 최선의 방법은 RabbitMQ같은 시스템을 이용하는것이다.

메시징 시스템은 채팅시스템을 시작으로 로그수집및 분석, 비동기처리 시스템, 분산 시스템 환경에서의 시스템 통합에 이르기까지 RabbitMQ의 활용범위는 무궁 무진하다. RabbitMQ는 메시지 큐를 활용하는 브로커로 서로 간에 메시지를 교환할 수 있는 여러 방법을 가지고 있다.


# 메시징, 도약의 첫걸음
소프트웨어 어플리케이션은 시스템간에 메시지를 교환해야 프로그래밍이 제대로 동작될 수 있다. 또 이 메시지가 제대로 도착햇는지 파악해야하고 받는 서버는 바로 응답을 해줘야한다. 

개발자는 이렇게되면 너무나 단순한 구조의 프로그래밍만을 구성해야한다. 또한 두지점간의 견고한 결합은 전체 시스템 구조를 변경하거나 발전시키는데 어려움을 준다.

그래서 여기에서 배울 메시징큐 시스템은 기조는 Request, Response가아닌 오로지 Request만 있는방식으로 시스템간에는 비동기 방식으로 메시지를 송신한다.

그럼 이런 구조가 될 수 있다. 메시지 발행자는 대상 시스템에 메시지를 송신이 필요하면 브로커에게 메시지를 전달한다. 따라서 응답이 필요한 경우에는 동일한 방식으로 발행자와 소비자의 역할만 뒤바꿔서 메시지를 전달하면 된다.

## 느슨하게 결한됩 시스템구성

### 장점
느슨하게 결합된 시스템 구성은 메시징 처리 방법에 있어 이점을 가진다. 시스템이 어떻게 구성되는지는 중요하지 않고, 단지 목적이 이름만 알면 메시지를 전달할 수 있기 때문입니다.


느스한 시스템 구성은 다음과 같은 특징이 있다.
* 발행자 또는 소비자 간 문제 발생시 서로 영향을 주지 않는다.
* 각시스템의 성능은 다른 측면에 영향을 미치지 않는다.
* 발행자와 소비자의 인스턴스 수는 작업량을 수용할 수 있을만큼 독립적으로 증가하고 감소한다
* 발행자는 소비자의, 소비자는 발행자의 위치가 어디인지 혹은 어떤 기술을 사용하는지 알지 못해도된다.

### 단점
어떤 일들이 연달아 발생할경우 절차적 프로그래밍 모델을 따를 수 없다는 것이다. 메시징 시스템에서는 시간의 흐름에 따라 특정 상황이 발생하므로 시스템이 이를 처리할수 있도록 프로그래밍되어야한다.

## AMQP
진일보한 메시징 큐 프로토콜(AMQP, Advanced Message Queuing Protocol)은 시스템간 메시지 교환하기 위해 공개 표준으로 정의한 프로토콜이다. AQP는 발행자와 소비자 브로커사이에 발생하는 상호작용 방식 뿐만아니라 메시지와 명령어 교환형태 또한 정의하고 있다.

## 핵심 개념
**브로커**
미들웨어 어플리케이션으로 발행자가 만든 메시지를 받을 수 도 있고 이를 소비자나 다른 브로커에게 전달할 수 있다.
**가상 호스트**
브로커 내의 가상 영역으로 대게 보안상의 이유로 발행자와 소비자, 그리고 모든 AMQP 구성요소를 분리할 수 있다.
**연결**
발행자와 소비자, 브로커 사이의 물리적인 네트워크(TCP) 연결로, 클라이언트 단절이나 네트워크 또는 브로커 장애가 발생했을 때에만 닫힌다.
**채널**
발행자와 소비자, 브로커 사이의 논리적인 연결로, 하나의 연결 내에 다수의 채널을 설정할 수 있다. 채널은 특정 클라이언트와 브로커간에 간섭이 일어나지 안도록 서로 간에 상호작용을 분리시킬 수 있으며, 연결에 비용이 많이드는 개별 TCP 연결을 개방하지 않고서도 가능하다. 채널은 프로토콜에 에러가 발생할 경우 닫힐 수 있다.
**익스체인지** : 발행한 모든 메시지가 처음 도달하는 지점으로 메시지가 목적지에 도달할 수 있도록 라우팅 규칙 적용을 담당한다 라우팅규칙은 아래와 같이 존재한다.
1. 다이렉트 : 포인 투 포인트
2. 토픽 : 토픽
3. 팬아웃 : 팬아웃

**큐** 메시지가 소비 되기전 대기하고 있는 최종 지점으로, 익스체인지 라우팅 규칙에 의해 단일 메시지가 복사 되거나 다수의 큐에 도다할 수 있다.

**결합**
익스체인지와 큐 간의 가상 연결로, 메시지가 익스체인지에서 큐로 이동할 수 있도록 하는 역할을 담당한다. 익스체인지 라우팅 규첵 따라 큐를 결합하는데 라우팅 키를 사용할 수 있다.




# 애플리케이션 수신함 만들기
RabbitMQ를 사용하는 애플리케이션은 영구적으로 연결을 설정해야한다. 연결을 하고나면 논리적인 채널을 생성할 수 있으며, 메시지를 주고받을 수 있는 시스템을 갖추게 된다. 

이장에서는 다이렉트 익스체인지, 익스체인지 라우팅, 패턴 매칭 라우팅키, 토피익스체인지를 학습할것이다.


# 서버 푸시로 전환

# 애플리케이션 로그 처리


# 메시지 전달처리


# 운영환경에서 RabbitMQ설정
지금까지 CCM은 운영환경의 모든 요구사항을 RabbitMQ단일 인스턴스에서 실행했다. 하지만 운영환경에서는 RabbitMQ를 단일 인스턴스로 구현할 수 없다. 왜냐하면 예상치못한일로 해당 RabbitMQ인스턴스가 죽어버리면 대체 불가능한 상황에 빠질 수 있기 때문이다.




## 브로커 단일 장애점 해결

### 미러링 큐 구성

### 클러스터에 연결

### 브로커 페더레이션

## 브로커 모니터링

## 요약

# 애플리케이션 테스팅과 추적

