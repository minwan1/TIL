다형성에대한생각..

스프링에서 interface를 두고 그 아래의 구현체를 둘때 런타임이든, 컴파일 의존성주입이든 어쩃든 한번은 의존성 주입을 해줘야한다. 처음에는 컨트롤단이든, 서비스단이든 아래와같이 어떤 구현체를 선택할지분기 처리가 필요하다, 팩토리패턴을 이용하든 어쨋든 한번의 분기 처리가 필요하다.

```java
@RestController
@RequestMapping("Cars")
public class CarController {

    @Autowired
    private AcarService acarService;
    @Autowired
    private BcarService bcarService;

    @RequestMapping(value = "/create", method = RequestMethod.POST)
    public Car createCar(@RequestParam(value = "car") String car) {
      if(car == "a"){
        return acarService.createCar();
      }else{
        return bcarService.createCar();
      }

    }

}

public interface CarService {
  Car createCar();
}

@Service
public class AcarService {
  public Car createCar(){
    //비지니스 로직
  }
}

@Service
public class BcarService {
  public Car createCar(){
    //비지니스로직
  }
}
```
그래서 이러한 문제를 해결할려면 그냥 아래와같이 컨트롤러를 분리해서 받는게 답인것같다.... 만약 둘중에 하나만 쓸거면 빈등록을해서 사용하는게 맞는데 두개다 쓰는거라면 두개의 컨트롤러가 존재하는게 맞다.

아래와같이 처리하는게 제일 깔끔한듯....

```java
@RestController
@RequestMapping("Cars")
public class CarController {

    @Autowired
    private AcarService acarService;
    @Autowired
    private BcarService bcarService;

    @RequestMapping(value = "/a", method = RequestMethod.POST)
    public Car createCar(@RequestParam(value = "car") String car) {
      return acarService.createCar();
    }
    @RequestMapping(value = "/b", method = RequestMethod.POST)
    public Car createCar(@RequestParam(value = "car") String car) {
      return bcarService.createCar();
    }

}

public interface CarService {
  Car createCar();
}

@Service
public class AcarService {
  public Car createCar(){
    //비지니스 로직
  }
}

@Service
public class BcarService {
  public Car createCar(){
    //비지니스로직
  }
}
```

##

번외로 securty에서  userdetails service를 생성하고 빈응 등록한다.이렇게 교체가 필요한시기에는 빈을 등록해서 사용하는데, 위처럼 만약 교체성이 아니라 두개를 사용한다면 빈등록을 이용한 다형성은 무의미한것같다.



##

이것은 두번째 번외인데 아예 컨트롤러를 분리하고 그 구현하고자하는 클래스를 던지는 방법도 하나의 방법일 수 가 있다


```java
@RestController
@RequestMapping("Cars")
public class CarController {

    @Autowired
    private AcarService acarService;
    @Autowired
    private BcarService bcarService;

    @Autowired
    private CarManager CarManager;

    @RequestMapping(value = "/a", method = RequestMethod.POST)
    public Car createCar(@RequestParam(value = "car") String car) {
      return CarManager.createCar(acarService);
    }
    @RequestMapping(value = "/b", method = RequestMethod.POST)
    public Car createCar(@RequestParam(value = "car") String car) {
      return CarManager.createCar(bcarService);
    }

}

public interface CarService {
  Car createCar(AcarService carService);
}

@Compone nt
public class CarManager {
  public Car createCar(AcarService carService){
    carService.createCar();
  }
}

@Service
public class AcarService {
  public Car createCar(AcarService carService){
    //비지니스 로직
  }
}

@Service
public class BcarService {
  public Car createCar(AcarService carService){
    //비지니스로직
  }
}
```
