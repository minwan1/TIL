## 컴퓨터 시스템 구조
### 컴퓨터 시스템의 구조
아래는 컴퓨터 시스템의 구조이다.
![](https://i.imgur.com/8JAIHTg.png)
간단하게 컴퓨터 시스템흐름을 설명하면 컴퓨터에 전원이 들어오게되면 메인메모리에 운영체제가 올라간다. 이때 모든 운영체제 코드가 올라가는게아니라 시스템이 돌아가기위한 부분이 먼저올라가는데 이부분을 커널이라한다. 이러한 이유는 모든 코드를 메모리에 올리게되면 자원낭비가 심하기때문이다. 그 이후에 CPU는 메모리의 운영체제 프로그램들을 읽어 운영체제를 실행한다. 운영체제가 시작되고 이때부터 다른 프로그램들을 실행시키면 마찬가지로 메인메모리에 올라가게 된다. 이때 각각의 프로그램들은 I/O 디바이스 사용이 필요할 수 있는데 이러한 요청은 운영체제한테 요청을해야한다. 이런 이유는 많은 이유가있지만 가장큰 이유는 보안때문이다. 운영체제는 각각의 I/O디바이스의 컨틀롤러에 요청을한다. 그리고 I/O디바이스 컨틀롤러들은 입출력을 받게되면 Interrupt를 발생시켜 CPU에게 작업이 끝났다고 알리게된다. CPU는 I/O디바이스에 버퍼에가서 데이터를 읽어와 메인메모리에 올려놓게 된다. 이러한 작업이 반복되는것이 컴퓨터 시스템의 원리이다.



#### Device Controller
각각의 디바이스들을 I/O연산, 제어관리를 하는 역할을 한다.(각각의 디바이스들의 CPU역할)
**Device Driver**
운영체제가 각각의 디바이스를 접근하게 하기위한 인터페이스역할을하는 소프트웨어
**펌웨어**
디바이스가 동작하기위한 소프트웨어

#### Buffer
각각의 디바이스 컨트롤러들이 명령을 내려 디바이스의 데이터를 읽어오거나 출력할때는 데이터를 저장하는공간이다. (각각의 디바이스들의 램역할)

#### Timer
특정 프로그램이 무한루프에 빠져 CPU를 독점하는 경우를 막기위해 존재한다. 만약 특정프로그램이 CPU할당시간을 초과한다면 timer는 인터럽트를 발생시켜 CPU의 권한을 운영체제에게 다시 넘긴다.

#### mode bit
 CPU에서 지금 실행되는 프로그램이 프로그램인지 운영체제인지 구분해주는 역할

#### Interrupt
CPU는 I/O 디바이스들이 데이터를 입력할때까지기다리는게 아니라 자신의 일을 계속 처리하고있게 된다. 이때 I/O 디바이스들에게 입력이 이루어지면 각각의 디바이스컨틀롤러가 인터럽트를 발생시켜 CPU에게 알려준다. 이때 발생시키는 신호를 인터럽트라고한다.

#### DMA
CPU가 각각의 I/O디바이스를 통해 데이터를 읽어 메인메모리에 프로그램에게 전달하게되면 CPU효율이 떨어지기때문에 주변기기의 인터페이스 장치에 제어권을 주어 직접 주기억장치와 데이터를 주고 바는 방식으로 액세스하여 데이터를 전송하는 방법

#### System Call
응용프로그램이 운영체제의 서비스를 받기위해 커널함수르 호출하는것.

//CPU가 컨트롤러에 직접접근하나 ? OK

### 인터럽트의 일반적 기능
프로그램이 요청한 데이터를 디스크 컨트롤러가 로컬버퍼로 읽어온 후 인터럽트를 발생시켜면 CPU는 인터럽트가 들어옴을 인지하고 인터럽트 관련 업무를 수행한다. 운영체제 커널은 인터럽트가 들어왔을때 해야할일을 미리 프로그래밍으로 가지고있다.
디스크컨트롤러가 인터럽트를 발생시키면 CPU는 하던일을 잠시 멈추고 이 인터럽트가 발생했을때 수행해야할 코드영역으로 가서 작업을 수행한다. 인터럽트 작업을 다 수행하고 예를들어 B프로그램이 있다고하면 B프로그램이 CPU할당을 받은경우 다음 명령을 수행할수있음을 표시하고 다시 원래작업으로 돌아와 작업을 수행한다.
위에서 말한대로 인터럽트작업이 끝나면 원래 작업으로 돌아오기위해 주소정보등을 기록해야하는데 이러한 정보를 저장하기 위한 장소를 운영체제는 별도로 가지고 있다. 프로그램의 메모리 주소를 조사해보면 크게 코드, 데이터, 스택등으로 나뉜다.

#### 스택영역
실행중인 함수에서 다른 함수를 호출한경우 호출된 함수의 종료후 원래 함수의 실행이던 위치로 돌아오기 위해 복귀 주소를 저장하는 위치이다.
#### 데이터 영역
전역변수등 프로그램이 사용하는 각종 데이터가 저장되는 공간이다.
#### 코드 영역
프로그래머가 작성한 코드가 기계어 명령형태로 저장되는 영역이다.

### 인터럽트 핸들링
