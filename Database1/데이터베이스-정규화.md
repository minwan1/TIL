## 정규형이란


### 제1정규형(1NF)
제1정규형의 정의는 테이블 셀에 복합적인 값을 포함하지 않는다이다. 일반적으로 관계형 데이터베이스에서는 테이블 셀에 복합적인 값을 포함하는것이 불가능하기 때문이다. 따라서 관계형 데이터베이스의 테이블은 전부 제1정규형을 자동으로 만족한다. 여기에서 복합적인 값은 말그대로 복합적인 값을 말하는것입니다. 예를들어 과일이라는 컬럼이있으면 과일 컬럼에 귤,사과와같이 한컬럼에 2개의 값이 들어간것을 말한다.

테이블로 예를들어보자. 먼저 아래와같은 컬럼이 있다고 하자.

| 사원 ID | 이름   | 나이 | 성별 | 피부양자         |
| ------- | ------ | ---- | ---- | ---------------- |
| S001    | 김미경 | 38   | 여   | 박초롱           |
| S002    | 박유안 | 30   | 남   | 박안나           |
| S003    | 이관식 | 62   | 남   | (이수분, 이수인) |

다음 표는 사원 3명의 데이터를 가진 사원 테이블이다. 이름칼럼에 김미경, 박유안은 문제가 없다. 그런데 이관식 이름은 아이가 2명이어서 이수분, 이수인이라고 적었다고 가정해보자. 액셀같은 표를만들때는 위와같이 표기할 수 있겠지만 관계형 데이터베이스에서는 이것이 금지되어 있다. 정확히는 아래와같이 나누어야한다.


| 사원 ID | 이름   | 나이 | 성별 |
| ------- | ------ | ---- | ---- |
| S001    | 김미경 | 38   | 여   |
| S002    | 박유안 | 30   | 남   |
| S003    | 이관식 | 62   | 남   |

| 사원 ID | 피부양자 |
| ------- | -------- |
| S001    | 박초롱   |
| S002    | 박안나   |
| S003    | 이수인   |
| S003    | 이수분   |

사원 뿐만아니라 부양자 테이블을 만들어서 어느 쪽의 데이터도 셀에 한개의 값을 기재해 관리할 수 있게 되었다. 이런 '단일값' 이것 이상 나누는것이 가능하지 않은 값을 '스칼라값'이라한다. 제1정규형이란 스칼라값 이외의 값을 포함하지 않는 테이블이라한다. 물론 1정규형을 만족하여 아래와같이 테이블을 구성할 수 도 있다.

| 사원 ID | 이름   | 나이 | 성별 | 피보험자1 | 피보험자2 |
| ------- | ------ | ---- | ---- | --------- | --------- |
| S001    | 김미경 | 38   | 여   | 박초롱    | NULL      |
| S002    | 박유안 | 30   | 남   | 박안나    | NULL      |
| S003    | 이관식 | 62   | 남   |이수분   | 이수인    |

위 방법도 일단 1정규형의 테이블이다. 하지만 이방법이라면 아이가 3명 이상있는 사원 데이터를 등록할 수 없다. 여기에서 컬럼을 하나 더 늘린다고 생각할 수 도 있지만 만약 여기에서 아이가 1명이 더늘어나 4명이된다면 또 컬럼을늘려야한다. 테이블 정의를 도중에 변경하는것은 애플리케이션에 대한 영향이 매우 크기때문에 나중에 테이블 정의를 변경할 위험이 있는 설계는 바람직하지 않다. 테이블에서 사원, 피부양자란 두집합을 동시에 관리한다는 점도 의미를 알기 어려운 구조이다.


### 제2정규형(2NF) [부분함수종속]
제 2정규형은 테이블은 집합이다. 제 1정규형을 만족한 상황에서 제 2정규형을 만족하지 않는 테이블을 예로 들면 다음과 같다.

| 고객기업 ID | 주문번호 | 주문접수일 | 고객기업명 | 고객기업 규모 |
| ----------- | -------- | ---------- | ---------- | ------------- |
| CA          | O001     | 2014/12/20 | A상사      | 대규모        |
| CA          | O002     | 2014/12/21 | A상사      | 대규모              |
| CB          | O001     | 2014/12/12 | B상사      | 중규모              |
| CB          | O002     | 2014/12/25 | B상사      | 중규모              |
| CB          | O003     | 2014/12/25 | B상사      | 중규모              |
| CC          | O001     | 2014/12/1 | A상사      | 소규모              |

이 표는 클라이언트 기업에서 주문을 관리하는 테이블이다. 기본키는 {고객기업 ID, 주문번호}의 조합이며 이조합으로 행을 유일하게 특정하는것이 가능하다. 여기서 {고객기업 ID} 나 {주문번호} 단독으로는 고유성이 없다. 예를들어 {고객기업 ID}는 'CB'란 값이 3개의 행에 있어서 1행으로 특정하는것이 불가능하다. 마찬가지로 {주문번호}도 같은 문제가 발생한다. 이 2개의 열을 조합해야만 고유한 키가 발생한다.

이테이블은 전체의 셀이 스칼라 값으로 구성되어 있어서 의심할 여지 없이 제 1정규형을 충족하고 있다. 하지만 이테이브른 제 2정규형은 아니다. 왜냐하면 이테이블에는 '부분함수 종속성'이라는 함수 종속이 존재하기 때문이다. 부분함수 종속은 간단히 말하면 '기본키를 구성하는 열의 일부에만 함수 종속이 존재하는것'을 의미한다. 예를들어 다음과 같은 것이 함수 종속이다.

```
{고객기업 ID} -> {고객 기업명}
{고객기업 ID} -> {고객 규모}
```

기업의 이름은 기업 ID만 안다면 고유하게 특정할 수 있다. 기업의 규모도 마찬가지이다. 이 두 열에 한정해서 본다면 {주문번호}의 열은 쓸모없는 정보이다. 주문번호를 안다고 한들 어떤 기업에서의 주문인지는 전혀 파악할 필요가 없다.


| 고객기업 ID | 주문번호 | 주문접수일 | 고객기업명 | 고객기업 규모 |
| ----------- | -------- | ---------- | ---------- | ------------- |
| CA          | O001     | 2014/12/20 | A상사      | 대규모        |
| CA          | O002     | 2014/12/21 | A상사      | 대규모        |
| CB          | O001     | 2014/12/12 | B상사      | 중규모        |
| CB          | O002     | 2014/12/25 | B상사      | 중규모        |
| CB          | O003     | 2014/12/25 | B상사      | 중규모        |
| CC          | O001     | 2014/12/1  | A상사      | 소규모        |

이와같이 부분함수 종속이 존재할경우 해당 키와 종속하는 열만 다른테이블로 만들어 외부로 꺼낸다.

|  고객기업 ID | 주문번호 | 주문접수일 |
| ----------- | -------- | ---------- |
| CA          | O001     | 2014/12/20 |
| CA          | O002     | 2014/12/21 |
| CB          | O001     | 2014/12/12 |
| CB          | O002     | 2014/12/25 |
| CB          | O003     | 2014/12/25 |
| CC          | O001     | 2014/12/1 |        


| 고객기업 ID | 고객기업명 | 고객기업 규모 |
| ----------- | ---------- | ------------- |
| CA          | A상사      | 대규모        |
| CB          | B상사      | 중규모        |
| CC          | A상사      | 소규모        |

이처럼 나누어진 고객 기업 주문 테이블과 고객 기업 테이블은 둘다 제 2정규형을 충족하고 있다. 그 증거로 전체 열이 기본키만으로도 함수 종속을 가지고 있으며 기본키의 일부에만 종속하는 열은 없다. 또한 제 2정규형을 '테이블은 집합이다.'란 관점에서 보면 2개의 테이블로 나눈후 명확하게 주문, 고객이라는 집합에 대응하고 있음을 알 수 있다. 각행이 하나의 주문또는 기업을 나타낸다.


### 제3정규형(3NF) [추이함수 종속]
제 3정규형은
제 2정규형을 충족하면서 갱신 이상 위험은 많이 줄었다. 하지만 아직 이것만으로는 충분하지 않다. 만약 아래와같이 업계정보를 테이블에 추가해야할 수 있다.

| 고객기업 ID | 고객 기업명 | 고객기업규모 | 업계코드 | 업계명 |
| ----------- | ----------- | ------------ | -------- | ------ |
| CA          | A상사       | 대규모       | D001     | 석유   |
| CB          | B건설       | 중규모       | D002     | 건설   |
| CC          | C화학       | 소규모       | D003     | 바이오 |

위 내용은 제 1정규형인 테이블 셀에 복합적인 값을 넣지 않는다와 제2정규형인 테이블은 집합이다를 모두 만족한다. 하지만 이 테이블에도 역시 갱신 이상이 존재한다. 예를들어 앞으로 관리하고 싶은 업계는 석유, 건설, 바이오외에도 시스템 또는 유통등 다양하다고 해도 지금은 이테블에 해당 업계를 등록할 수 있는 방법은 없다.

이와같은 사태가 발생한 이유는 이 테이블에도 한 개의 함수 종속, 즉 '추이함수 종속'을 가져왔기 때문이다. 이것은 기본키 이외의 키 간에 발생하는 함수 종속으로 여기서는 다음의 종속이 해당한다.

```
{업계코드} -> {업계명}
```

'추이함수 종속'에 '추이'라는 이름이 붙은 것은 다음처럼 기본키에서 볼 때 2단계의 함수 종속이 존재하기 때문이다.
```
{고객기업 ID} -> {업계코드} -> 업계명
```
이와 같은 함수 종속도 제 2정규형과 동일하게 테이블을 나누어 외부로 빼놓아야한다.

**고객기업 테이블(제3정규형)**
| 고객기업 ID | 고객 기업명 | 고객기업규모 | 업계코드 | 업계명 |
| ----------- | ----------- | ------------ | -------- | ------ |
| CA          | A상사       | 대규모       | D001     | 석유   |
| CB          | B건설       | 중규모       | D002     | 건설   |
| CC          | C화학       | 소규모       | D003     | 바이오 |

**업계 테이블(제3정규형)**
| 고객기업 ID | 고객 기업명 | 고객기업규모 | 업계코드 | 업계명 |
| ----------- | ----------- | ------------ | -------- | ------ |
| CA          | A상사       | 대규모       | D001     | 석유   |
| CB          | B건설       | 중규모       | D002     | 건설   |
| CC          | C화학       | 소규모       | D003     | 바이오 |

이제는 '업계 테이블'에 원하는 만큼 새로운 업계를 추가할 수 있다. 제3정규형을 다시 집합관점에서 위 테이블을 보면 명백히 고객기업 테이블과 업계테이블을 한테이블에서 관리하려고 했다는것을 알 수 있다.
