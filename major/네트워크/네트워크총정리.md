# 네트워크 총정리

다음은 클라이언트와 서버가 통신하는 과정을 도식화한것이다.
![](https://i.imgur.com/uMyrjMJ.gif)


## 클라이언트


![](https://i.imgur.com/eOPv7fW.png)
**데이터 전송시 TCP/IP 네트워크 스택의 각레이어별 동작 과정**

1. 먼저 클라이언트(사용자)는 운영체제에게 부탁하여 소켓을 연다.
2. 그러면 운영체제는 File discripter(소켓)를 리턴해준다.
3. 클라이언트는 write시스템콜을 send socket buffer 에 보낼 데이터를 넘긴다.
4. 


> file discripter : 프로토콜 스택의 내부에 이는 다수의 소켓중 어느것을 가리키는지를 나타내는 번호표와 같은 존재이다.
> 프로토콜 스택 : OS 내부에 내장된 네트워크 제어용 소프트웨어, '프로토콜 드라이버', 'TCP/IP소프트웨어' 등으로 부릅니다

* 소켓은 send socket buffer, 수신용으로 receive socker buffer를 가진다. 
* Write 시스템 콜을 호출하면 유저 영역의 데이터가 커널 메모리로 복사되고, send socket buffer의 뒷부분에 추가된다. 순서대로 전송하기 위해서다. 그림에서 옅은 회식 상자가 이미 socket buffer에 존재하는 데이터를 의미한다. 

## 서버


1. 물리계층을 기반으로 0,1,0,1 통신을한다. 
2. 그리고 데이터 링크계층을 기반으로 mac주소를 찾아 통신을한다.(이때 IP주소를 기반으로 mac주소를 찾는데 이것은 ARP라고한다.)
3. 네트워크 계층에서 ip를 기반으로 노드를 찾는다.
4. 전송계층에서 TCP를 기반으로 데이터의 신뢰도성을 확인한다
5. 세션 계층에서 포트를 확인한다
6. 표현 계층에서 이해당 데이터가 jpg인지 txt에따라 데이터를 풀이? 하낟
7. 응용 계층에서 데이터를 유저에게 보여준다.



----

자바에서 네트워크 통신을 하기 위해서는 소켓을 생성을 한다. 소켓은 세션,표현,응용 계층과 그아래 전송계층이하를 연결해준다. 이 소켓은 연결하고하는 네트워크에 노드에 IP와 포트를 지정한다. 그리고 해당 서버에 연결을 요청을하면 서버가 수락을 한다면 통신을 할 수 있다. 이때 서버는 새로운 소켓을 생성을 하여 그 소켓을 기반으로 클라이언트에 만들어진 소켓과 통신을 한다. 

그럼 이사이에 소켓은 무엇을할까.... 전송계층에서 이미 안전한 데이터만 소켓으로 넘겨준걸까 ? 그런거겠지.. 3way 핸드쉐킹은 소켓이 했을 수 도 있음.



랜카드는 들어온 프레임의 목적지 맥 어드레스를 보고 나서 자신의 맥 어드세르와 비교한 후 자기것이 아니면 버리게 됩니다.


## 


## 운영체제


// 브로드 캐스트를 통해 IP를 찾는다. 


